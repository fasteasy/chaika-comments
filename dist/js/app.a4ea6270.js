(function(t){function e(e){for(var r,s,c=e[0],i=e[1],u=e[2],l=0,p=[];l<c.length;l++)s=c[l],Object.prototype.hasOwnProperty.call(a,s)&&a[s]&&p.push(a[s][0]),a[s]=0;for(r in i)Object.prototype.hasOwnProperty.call(i,r)&&(t[r]=i[r]);m&&m(e);while(p.length)p.shift()();return o.push.apply(o,u||[]),n()}function n(){for(var t,e=0;e<o.length;e++){for(var n=o[e],r=!0,c=1;c<n.length;c++){var i=n[c];0!==a[i]&&(r=!1)}r&&(o.splice(e--,1),t=s(s.s=n[0]))}return t}var r={},a={app:0},o=[];function s(e){if(r[e])return r[e].exports;var n=r[e]={i:e,l:!1,exports:{}};return t[e].call(n.exports,n,n.exports,s),n.l=!0,n.exports}s.m=t,s.c=r,s.d=function(t,e,n){s.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},s.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},s.t=function(t,e){if(1&e&&(t=s(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(s.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)s.d(n,r,function(e){return t[e]}.bind(null,r));return n},s.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return s.d(e,"a",e),e},s.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},s.p="/";var c=window["webpackJsonp"]=window["webpackJsonp"]||[],i=c.push.bind(c);c.push=e,c=c.slice();for(var u=0;u<c.length;u++)e(c[u]);var m=i;o.push([0,"chunk-vendors"]),n()})({0:function(t,e,n){t.exports=n("56d7")},"0170":function(t,e,n){},"2a13":function(t,e,n){"use strict";var r=n("c4fc"),a=n.n(r);a.a},"2a7b":function(t,e,n){"use strict";var r=n("9f42"),a=n.n(r);a.a},"37b2":function(t,e,n){"use strict";var r=n("0170"),a=n.n(r);a.a},5033:function(t){t.exports=JSON.parse('{"comments":[{"user":"111","id":"123","username":"Пациент Петрович","avatar":"https://shawglobalnews.files.wordpress.com/2019/07/the-mask.png?w=720&h=480&crop=1","text":"Hi doc!","updated":"","created":""},{"user":"222","parent":"123","id":"124","username":"Доктор Дмитриевич","avatar":"https://chaika.com/images/avatar/3802105d0c14f67ad1debcc5e45ea06d.jpeg?crop=1806px,1806px,2389px,503px","text":"Hello!","updated":"","created":""},{"user":"222","parent":"123","id":"125","username":"Доктор Дмитриевич","avatar":"https://chaika.com/images/avatar/3802105d0c14f67ad1debcc5e45ea06d.jpeg?crop=1806px,1806px,2389px,503px","text":"How r u?","updated":"","created":""},{"user":"111","parent":"123","id":"126","username":"Пациент Петрович","avatar":"https://shawglobalnews.files.wordpress.com/2019/07/the-mask.png?w=720&h=480&crop=1","text":"Fine! Thx","updated":"","created":"  "},{"user":"111","parent":"123","id":"127","username":"Пациент Петрович","avatar":"https://shawglobalnews.files.wordpress.com/2019/07/the-mask.png?w=720&h=480&crop=1","text":"And u?","updated":"","created":""},{"user":"111","id":"128","username":"Пациент Петрович","avatar":"https://shawglobalnews.files.wordpress.com/2019/07/the-mask.png?w=720&h=480&crop=1","text":"One more comment","updated":"","created":""}]}')},"54a6":function(t,e,n){"use strict";var r=n("fe5f"),a=n.n(r);a.a},"56d7":function(t,e,n){"use strict";n.r(e);n("e260"),n("e6cf"),n("cca6"),n("a79d");var r=n("2b0e"),a=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{attrs:{id:"app"}},[n("div",{staticClass:"container"},[n("comments",{attrs:{items:t.comments},on:{update:t.edit,remove:t.remove}})],1)])},o=[],s=(n("a4d3"),n("4de4"),n("4160"),n("e439"),n("dbb4"),n("b64b"),n("159b"),n("2fa7")),c=n("2f62"),i=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"comments"},[t.hasComments?n("comments-list",{attrs:{comments:t.items}}):[t._v("No comments")],n("reply-form",{staticClass:"comments__reply-form",on:{submit:t.postComment},model:{value:t.reply,callback:function(e){t.reply=e},expression:"reply"}})],2)},u=[],m=(n("0d03"),n("d3b7"),n("25f0"),{create:function(t){var e=Math.floor(1e5*Math.random()).toString();return new Promise((function(t,n){setTimeout((function(){t(e)}),300)}))},update:function(t,e){return new Promise((function(t){setTimeout((function(){t()}),500)}))},remove:function(t){return new Promise((function(t){setTimeout((function(){t()}),500)}))}}),l=(n("99af"),n("9f12")),p=n("53fe"),d=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Object(l["a"])(this,t),this.parent=e.parent,this.id=e.id,this.user=e.user,this.username=e.username,this.text=e.text,this.created=e.created,this.updated=e.updated,this.comments=[].concat(e.comments),this.avatar=e.avatar}return Object(p["a"])(t,[{key:"defaults",value:function(){return{parent:null,user:null,id:null,username:null,avatar:null,text:null,created:null,updated:null,comments:null,isUser:null}}}]),t}(),f=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("form",{staticClass:"reply-form",on:{submit:function(e){return e.preventDefault(),t.submit(e)}}},[t.showAvatar?n("div",{staticClass:"reply-form__aside"},[n("avatar",{staticClass:"reply-form__avatar",attrs:{image:t.comment.avatar,username:t.comment.username}})],1):t._e(),n("div",{staticClass:"reply-form__main"},[n("textarea",{staticClass:"reply-form__textarea",attrs:{name:"reply",rows:"1",placeholder:"Оставьте свой комментарий..."},domProps:{value:t.comment.text},on:{input:t.input}}),n("button",{staticClass:"reply-form__submit",attrs:{type:"submit",disabled:!t.isValid}},[t._v(" Комментировать ")]),n("button",{attrs:{type:"button"},on:{click:function(e){return t.$emit("cancel")}}},[t._v("×")])])])},v=[],b=(new r["a"],function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("figure",{staticClass:"avatar",class:t.classList,attrs:{title:t.username}},[t.image?n("img",{staticClass:"avatar__image",attrs:{src:t.image,alt:t.username}}):n("div",{staticClass:"avatar__image avatar__placeholder"}),t.abbr&&!t.image?n("figcaption",{staticClass:"avatar__username",attrs:{"aria-label":t.username}},[t._v(t._s(t.abbr))]):t._e()])}),h=[],y=(n("a15b"),n("d81d"),n("ac1f"),n("1276"),{props:{image:{type:String,default:""},username:{type:String,default:""},size:{type:String,default:"md"}},computed:{classList:function(){return Object(s["a"])({},"avatar--".concat(this.size),!0)},abbr:function(){return this.username.split(" ").map((function(t){return t[0]})).join(" ")}}}),_=y,g=(n("2a13"),n("2877")),O=Object(g["a"])(_,b,h,!1,null,null,null),w=O.exports,C={components:{Avatar:w},model:{prop:"comment",event:"input"},props:{showAvatar:{type:Boolean,default:!0},comment:{default:function(){return{}},type:Object}},computed:{isValid:function(){return!!this.comment.text}},methods:{input:function(t){this.$emit("input",Object.assign({},this.comment,{text:t.target.value}))},submit:function(){var t=this.comment,e=t.parent,n=t.text;this.$emit("submit",{parent:e,text:n})}}},j=C,x=(n("37b2"),Object(g["a"])(j,f,v,!1,null,null,null)),P=x.exports;function L(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function k(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?L(n,!0).forEach((function(e){Object(s["a"])(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):L(n).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var R={components:{ReplyForm:P},props:{items:{type:Array,default:function(){return[]}}},data:function(){return{reply:new d}},computed:{hasComments:function(){return this.items&&this.items.length}},methods:k({},Object(c["b"])({add:"comments/add"}),{reset:function(){this.reply=new d},postComment:function(t){this.add(t),this.reset()}})},D=R,S=(n("54a6"),Object(g["a"])(D,i,u,!1,null,null,null)),M=S.exports,H=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"comment"},[n("div",{staticClass:"comment__base"},[n("div",{staticClass:"comment__aside"},[n("div",{staticClass:"comment__avatar"},[n("avatar",{attrs:{username:t.comment.username,image:t.comment.avatar}})],1)]),n("div",{staticClass:"comment__main"},[t.editable?n("reply-form",{attrs:{"show-avatar":!1},on:{submit:t.save,cancel:t.cancel},model:{value:t.editable,callback:function(e){t.editable=e},expression:"editable"}}):n("div",{staticClass:"comment__text"},[t._v(" "+t._s(t.comment.text)+" ")]),t.editable?t._e():n("div",{staticClass:"comment__footer"},[n("div",{staticClass:"comment__actions"},[t.comment.isUser?[n("button",{staticClass:"comment__action",attrs:{type:"button"},on:{click:t.edit}},[n("svg",{staticClass:"comment__action-icon",attrs:{viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg"}},[n("g",{attrs:{opacity:"0.56"}},[n("path",{attrs:{d:"M15.8119 3.62902C14.9731 2.79033 13.6132 2.79033 12.7745 3.62902L4.25963 12.1431C4.20127 12.2014 4.15914 12.2738 4.13714 12.3532L3.01742 16.3953C2.97137 16.561 3.01816 16.7385 3.13972 16.8602C3.26146 16.9818 3.43894 17.0286 3.60468 16.9827L7.64714 15.8629C7.72656 15.8409 7.7989 15.7988 7.85725 15.7404L16.3719 7.22614C17.2094 6.38689 17.2094 5.02827 16.3719 4.18902L15.8119 3.62902ZM5.29956 12.4533L12.2683 5.485L14.5158 7.73227L7.54684 14.7006L5.29956 12.4533ZM4.85063 13.3541L6.64618 15.1496L4.1625 15.8377L4.85063 13.3541ZM15.697 6.55131L15.1908 7.05743L12.9432 4.80998L13.4495 4.30385C13.9154 3.838 14.6709 3.838 15.1368 4.30385L15.697 4.86385C16.1622 5.33027 16.1622 6.08508 15.697 6.55131Z",fill:"currentColor"}})])]),n("span",[t._v("Edit")])]),t.removed?t._e():n("button",{staticClass:"comment__action",attrs:{type:"button"},on:{click:function(e){t.removed=!0}}},[n("svg",{staticClass:"comment__action-icon",attrs:{viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg"}},[n("g",{attrs:{opacity:"0.56"}},[n("path",{attrs:{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M12.6574 7.82754L11.5662 7.78664L11.3292 14.2747L12.4211 14.3148L12.6574 7.82754ZM9.4535 14.2955H10.5462V7.80671H9.4535V14.2955ZM8.67049 14.2747L8.43344 7.78664L7.34155 7.82679L7.5786 14.3148L8.67049 14.2747Z",fill:"currentColor"}}),n("path",{attrs:{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M7.3054 5.10219V3.9139C7.30559 3.67158 7.40158 3.43924 7.57228 3.26789C7.74297 3.09654 7.97443 3.00019 8.21582 3H11.7842C12.0257 3.00019 12.2572 3.09665 12.428 3.26815C12.5987 3.43966 12.6946 3.6722 12.6946 3.91464V5.10219H16.5V6.19828H15.3429L14.4399 16.4995C14.428 16.6361 14.3656 16.7632 14.265 16.8559C14.1643 16.9485 14.0327 16.9999 13.8961 17H6.08533C5.94877 16.9999 5.81718 16.9485 5.71653 16.8559C5.61587 16.7632 5.55346 16.6361 5.5416 16.4995L4.63784 6.19902H3.5V5.10219H7.3054ZM8.39806 5.10219H11.6019V4.09683H8.39806V5.10219ZM13.3961 15.9032L14.2465 6.19902H5.73494L6.58536 15.9032H13.3961Z",fill:"currentColor"}})])]),n("span",[t._v("Delete")])]),t.removed?[n("button",{staticClass:"comment__action",attrs:{type:"button"},on:{click:function(e){return t.remove(t.comment.id)}}},[n("span",[t._v("Yes")])]),n("button",{staticClass:"comment__action",attrs:{type:"button"},on:{click:function(e){t.removed=!1}}},[n("span",[t._v("No")])])]:t._e()]:t._e(),n("button",{staticClass:"comment__action",attrs:{type:"button"},on:{click:t.createReply}},[n("span",[t._v("Reply")])])],2),t.date?n("div",{staticClass:"comment__date"},[t._v(t._s(t.date))]):t._e()])],1)]),t.reply?n("div",{staticClass:"comment__reply"},[n("reply-form",{on:{submit:t.sendReply,cancel:t.cancelReply},model:{value:t.reply,callback:function(e){t.reply=e},expression:"reply"}})],1):t._e(),t.comment.comments.length?n("comments-list",{staticClass:"comment__replies",attrs:{comments:t.comment.comments}}):t._e()],1)},E=[],T=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("ul",{staticClass:"comments-list"},t._l(t.comments,(function(e){return n("li",{key:e.id,staticClass:"comments-list__item",class:{"is-reply":t.isReply(e)}},[n("comment",{attrs:{comment:e}})],1)})),0)},$=[],V={name:"comments-list",props:{comments:{type:Array,default:function(){return[]}}},methods:{isReply:function(t){return!!t.parent}}},Z=V,I=Object(g["a"])(Z,T,$,!1,null,null,null),A=I.exports;function B(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function F(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?B(n,!0).forEach((function(e){Object(s["a"])(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):B(n).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var J,N,U={components:{Avatar:w,ReplyForm:P,CommentsList:A},props:{comment:{type:Object,default:function(){return{}}}},data:function(){return{editable:null,reply:null,showReply:!1,removed:!1}},computed:{date:function(){var t=this.comment.updated||this.comment.created;return!!t&&new Date(t).getTime()},isRootComment:function(){return!this.comment.parent}},methods:F({},Object(c["b"])({add:"comments/add",update:"comments/edit",remove:"comments/remove"}),{edit:function(){this.editable=new d(this.comment)},cancel:function(){this.editable=null},save:function(){this.editable.text!==this.comment.text&&(this.update(this.editable),this.cancel())},getParentId:function(){return this.comment.id},createReply:function(){this.reply=new d({parent:this.getParentId()})},sendReply:function(t){this.add(t),this.cancelReply()},cancelReply:function(){this.reply=null},getRootComment:function(t){return t.isRootComment?t.comment.id:this.getRootComment(t.$parent)}})},z=U,Y=(n("2a7b"),Object(g["a"])(z,H,E,!1,null,null,null)),q=Y.exports,G={extends:q,methods:{getParentId:function(){return this.getRootComment(this)}}},K=G,Q=Object(g["a"])(K,J,N,!1,null,null,null),W=Q.exports;function X(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function tt(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?X(n,!0).forEach((function(e){Object(s["a"])(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):X(n).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}r["a"].component("comment",W),r["a"].component("comments-list",A);var et={name:"app",components:{Comments:M},created:function(){this.loadComments()},computed:tt({},Object(c["c"])({comments:"comments/hierarchy"})),methods:tt({},Object(c["b"])({loadComments:"comments/load",remove:"comments/remove",edit:"comments/edit"}))},nt=et,rt=(n("5c0b"),Object(g["a"])(nt,a,o,!1,null,null,null)),at=rt.exports,ot=(n("c740"),n("fb6a"),n("a434"),n("5033")),st={namespaced:!0,state:{userId:"111",comments:[]},getters:{hierarchy:function(t){var e=t.userId,n=t.comments.slice();function r(t){var a=new d(t);return a.isUser=t.user===e,a.comments=n.filter((function(e){return e.parent===t.id})).map(r),a}var a=n.map(r).filter((function(t){return!t.parent}));return a}},actions:{load:function(t){var e=t.commit;return new Promise((function(t,n){setTimeout((function(){t(e("update",ot.comments))}),500)}))},remove:function(t,e){var n=t.commit;return m.remove(e).then((function(){n("remove",e)}))},add:function(t,e){var n=t.commit,r=t.state;return e.created=(new Date).getTime(),e.user=r.userId,m.create(e).then((function(t){e.id=t,n("add",e)}))},edit:function(t,e){var n=t.commit;return e.updated=(new Date).getTime(),m.update(e.id,e).then((function(){return n("edit",e)}))}},mutations:{remove:function(t,e){var n=t.comments,r=n.findIndex((function(t){return t.id===e}));r<0||n.splice(r,1)},update:function(t,e){t.comments=e.slice()},edit:function(t,e){var n=t.comments,r=n.findIndex((function(t){return t.id===e.id}));n[r]=e,t.comments=t.comments.slice()},add:function(t,e){t.comments.push(e)}}};r["a"].use(c["a"]);var ct=new c["a"].Store({modules:{comments:st}});r["a"].config.productionTip=!1,new r["a"]({store:ct,render:function(t){return t(at)}}).$mount("#app")},"5c0b":function(t,e,n){"use strict";var r=n("9c0c"),a=n.n(r);a.a},"9c0c":function(t,e,n){},"9f42":function(t,e,n){},c4fc:function(t,e,n){},fe5f:function(t,e,n){}});
//# sourceMappingURL=app.a4ea6270.js.map